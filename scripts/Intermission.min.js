function Intermission(a,b,c,d){this.stage=a;this.renderer=b;this.game=c;this.gamemen=d;this.men=[];this.playerfuel=4;a=PIXI.Texture.fromFrame("bg-1.png");this.bg1=new PIXI.Sprite(a,a.width,a.height);a=PIXI.Texture.fromFrame("bg-2.png");this.bg2=new PIXI.Sprite(a,a.width,a.height);this.bg2.position.y=540-this.bg2.height;a=PIXI.Texture.fromFrame("moon.png");this.moon=new PIXI.Sprite(a,a.width,a.height);this.moon.position.x=480-this.moon.width/2;this.moon.position.y=50;this.stage.addChild(this.bg1);
this.stage.addChild(this.bg2);this.stage.addChild(this.moon);this.city=[];this.buildCity();this.congrats();this.sound=(new Howl({urls:["resources/sounds/cheer.mp3"],volume:1})).play()}Intermission.WORLDMAX=960;Intermission.constructor=Intermission;Intermission.prototype=Object.create(Object.prototype);
Intermission.prototype.congrats=function(){var a,b,c=0,d;for(b=0;b<this.gamemen.length;b++)"saved"===this.gamemen[b].status&&c++;d=Math.floor(50*(c/this.gamemen.length*100-Math.floor(50+this.game.wave/5*5)));0<d&&(this.game.score+=d,a=new PIXI.Text("Extra effort bonus: "+d,{font:"20px Play",fill:"white",align:"left"}),a.position.x=480-a.width/2,a.position.y=this.moon.position.y+this.moon.height+5,this.stage.addChild(a));b=new PIXI.Text("Congratulations!",{font:"20px Play",fill:"white",align:"left"});
b.position.x=480-b.width/2;b.position.y=0<d?a.position.y+a.height+5:this.moon.position.y+this.moon.height+5;this.stage.addChild(b);a=new PIXI.Text("You saved "+c+" of "+this.gamemen.length+" men",{font:"20px Play",fill:"white",align:"left"});a.position.x=480-a.width/2;a.position.y=b.y+b.height+5;this.stage.addChild(a);b=new PIXI.Text("Hit 'Enter' key to continue the fight...",{font:"20px Play",fill:"white",align:"left"});b.position.x=480-b.width/2;b.position.y=a.y+a.height+5;this.stage.addChild(b)};
Intermission.prototype.buildCity=function(){for(var a=0,b,c,d;a<Intermission.WORLDMAX;)b=Math.ceil(3*Math.random())-1,160>Intermission.WORLDMAX-a&&(b=0),c=0===b?new BuildingObject("building03x1.png",80,156,Intermission.WORLDMAX,540,960,540,a,384):1===b?new BuildingObject("building02x1.png",80,188,Intermission.WORLDMAX,540,960,540,a,352):new BuildingObject("building01x2.png",160,125,Intermission.WORLDMAX,540,960,540,a,415),a=0===b||1===b?a+80:a+160,0.75>Math.random()&&(b=c.worldx+Math.floor(c.width/
2)-6,d=c.worldy-24,b=new ManObject(this,GameWorld.WORLDMAX,540,960,540,b,d),this.stage.addChild(b),this.men.push({sprite:b,flyingsprite:null,status:"standing",fallheight:null})),this.stage.addChild(c),this.city.push(c)};Intermission.prototype.cleanup=function(){this.sound.stop()};Intermission.prototype.status=function(){return!0};Intermission.prototype.secondTick=function(a){for(a=0;a<this.men.length;a++)this.men[a].sprite.everySecond("cheering")};
Intermission.prototype.update=function(a){var b;for(b=0;b<this.city.length;b++)this.city[b].update(0);for(b=0;b<this.men.length;b++)this.men[b].sprite.update(0,this.men[b],null,a);this.renderer.render(this.stage)};Intermission.prototype.checkKeyUp=function(a){};Intermission.prototype.checkKeyDown=function(a){};
