function RescueShip(a,c,d,b,e,f,g,h){this.world=a;this.stage=c;this.worldwidth=d;this.worldheight=b;this.viewwidth=e;this.viewheight=f;this.worldx=g;this.worldy=h;this.center=new PARTSYS.Vector(g+56,h+112);PIXI.DisplayObjectContainer.call(this);this.texture_door="rescue_door_1.png rescue_door_2.png rescue_door_3.png rescue_door_4.png rescue_door_5.png rescue_door_6.png rescue_door_7.png".split(" ");this.textureManWalking="man_walking_1_l.png man_walking_2_l.png man_walking_3_l.png man_walking_4_l.png man_walking_5_l.png man_walking_6_l.png".split(" ");
a=PIXI.Texture.fromFrame("rescue_door_1.png");this.door=new PIXI.Sprite(a,a.width,a.height);this.door.position.x=46;this.door.position.y=124;this.doorincrement=0;this.doorincrementdelta=0.1;a=PIXI.Texture.fromFrame("rescueship.png");this.ship=new PIXI.Sprite(a,a.width,a.height);this.ship.position.x=0;this.ship.position.y=0;a=PIXI.Texture.fromFrame("gantrypiece.png");this.gantry=new PIXI.Sprite(a,a.width,a.height);this.gantry.position.x=45;this.gantry.position.y=120;this.man=null;this.men=0;this.waitingfordoor=
!1;this.addChild(this.door);this.addChild(this.ship);this.addChild(this.gantry);this.width=189;this.height=224;this.shiptakeoff=this.shiplaunchcomplete=this.visible=!1;this.takeoffdelta=0.1;this.particlesystem=new PARTSYS.ParticleSystem;this.g=new PIXI.Graphics;this.addChild(this.g)}RescueShip.constructor=RescueShip;RescueShip.prototype=Object.create(PIXI.DisplayObjectContainer.prototype);
RescueShip.prototype.takeoff=function(){var a;this.gantry.visible=!1;a=new PARTSYS.Field(-960,0,1920,this.height+540);a.onFieldInfluenced=this.applyGravity.bind(this);this.gravitypos=new PARTSYS.Vector(0,0);this.thrusteremitter=new PARTSYS.Emitter;this.thrusteremitter.x=49;this.thrusteremitter.y=215;this.thrusteremitter.area={xanchor:0,yanchor:0,width:14,height:2,radius:0};this.thrusteremitter.density={min:5,max:15};this.thrusteremitter.angle={min:87,max:93};this.thrusteremitter.speed={min:3,max:5};
this.thrusteremitter.rotation=0;this.thrusteremitter.particlerotation={min:-1,max:1};this.thrusteremitter.emitterfields=[a];this.thrusteremitter.bounded={x:-960,y:0,width:1920,height:220,type:"die"};this.thrusteremitter.maxparticles=0;this.thrusteremitter.dienoparticles=!1;this.thrusteremitter.lockparticles=!0;this.thrusteremitter.onCreateParticle=this.createFireParticle.bind(this);this.thrusteremitter.onUpdateParticles=this.updateParticles.bind(this);this.thrusteremitter.onRemoveParticle=this.removeParticle.bind(this);
this.particlesystem.addEmitter("thrusters",this.thrusteremitter);this.shiptakeoff=!0};RescueShip.prototype.createFireParticle=function(a){var c=PIXI.Texture.fromFrame("explodicle.png");a.sprite=new PIXI.Sprite(c,2,2);a.sprite.position.x=a.position.x;a.sprite.position.y=a.position.y;a.sprite.anchor.x=0.5;a.sprite.anchor.y=0.5;this.addChild(a.sprite)};
RescueShip.prototype.createSmokeParticle=function(a){var c=PIXI.Texture.fromFrame("smokicle.png");a.sprite=new PIXI.Sprite(c,2,2);a.sprite.position.x=a.position.x;a.sprite.position.y=a.position.y;a.sprite.anchor.x=0.5;a.sprite.anchor.y=0.5;this.addChild(a.sprite)};RescueShip.prototype.updateParticles=function(a,c){var d,b;for(d=0;d<c.length;d++)b=c[d],b.sprite.position.x=b.position.x,b.sprite.position.y=b.position.y,b.sprite.rotation=PARTSYS.degreesToRadians(b.angle)};
RescueShip.prototype.removeParticle=function(a){this.removeChild(a.sprite);a.sprite=null};RescueShip.prototype.applyWell=function(a,c,d,b){var e=0,f=0,e=c-a.position.x,f=d-a.position.y;a=b/Math.pow(e*e+f*f,1.5);return new PARTSYS.Vector(e*a,f*a)};RescueShip.prototype.applyGravity=function(a){a.velocity.selfAdd(this.applyWell(a,56,300,1E4))};RescueShip.prototype.isClear=function(){return!(this.men||this.man)};
RescueShip.prototype.cleanup=function(){this.removeChild(this.door);this.removeChild(this.ship);this.removeChild(this.gantry);this.man&&this.removeChild(this.man)};RescueShip.prototype.everySecond=function(a){};
RescueShip.prototype.startMan=function(){var a;a=PIXI.Texture.fromFrame("man_walking_1_l.png");this.man=new PIXI.Sprite(a,a.width,a.height);this.man.position.x=this.gantry.position.x+this.gantry.width;this.man.position.y=this.gantry.position.y+2;this.man.textureincrement=0;this.man.visible=!0;this.addChildAt(this.man,2)};RescueShip.prototype.addMan=function(){this.men++;this.man||this.startMan()};
RescueShip.prototype.updateDoor=function(a){this.doorincrement+=this.doorincrementdelta;this.doorincrement>this.texture_door.length-1&&(this.doorincrementdelta=-this.doorincrementdelta,this.doorincrement+=this.doorincrementdelta,this.removeChild(this.man),this.man=null,this.men--,this.men&&this.startMan());0>this.doorincrement&&(this.doorincrement=0,this.doorincrementdelta=0.1,this.waitingfordoor=!1);a=PIXI.Texture.fromFrame(this.texture_door[Math.floor(this.doorincrement)]);this.door.setTexture(a)};
RescueShip.prototype.updateMan=function(a){this.man.position.x-=0.5*a*PARTSYS.framerate;this.man.position.x<this.gantry.x+6&&(this.man.textureincrement=0,this.waitingfordoor=!0);this.man.textureincrement+=0.1;this.man.textureincrement>this.textureManWalking.length-1&&(this.man.textureincrement=0);a=PIXI.Texture.fromFrame(this.textureManWalking[Math.floor(this.man.textureincrement)]);this.man.setTexture(a)};
RescueShip.prototype.update=function(a,c){this.visible=!1;var d,b=this.worldy,e,f=-1;e=a+this.viewwidth;e>this.worldwidth&&(f=e-this.worldwidth-1);-1===f?this.worldx>a-this.width&&this.worldx<e+this.width&&(d=this.worldx-a,this.visible=!0):this.worldx>a-this.width&&this.worldx<=this.worldwidth?(d=this.worldx-a,this.visible=!0):this.worldx<f+this.width&&(d=this.worldwidth-a+this.worldx,this.visible=!0);this.shiptakeoff&&(this.thrusteremitter.bounded.height+=this.takeoffdelta,this.worldy-=this.takeoffdelta,
this.takeoffdelta+=0.02,b=this.worldy,this.worldy<-1*this.ship.height-100&&(this.visible=!1,this.shiplaunchcomplete=!0),this.particlesystem.update());this.visible&&(this.position.x=d,this.position.y=b);this.man&&!this.waitingfordoor&&this.updateMan(c);this.waitingfordoor&&this.updateDoor(c)};
