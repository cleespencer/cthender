function ManObject(a,b,c,d,g,h,e){this.world=a;a="man_standing_1.png man_jumping_1.png man_jumping_2.png man_jumping_3.png man_jumping_4.png man_jumping_5.png man_waving_1.png man_waving_2.png man_waving_3.png man_waving_4.png man_waving_5.png man_waving_6.png man_waving_7.png man_waving_8.png man_flail_1.png man_flail_2.png man_flail_3.png man_flail_4.png man_flail_5.png man_flail_6.png man_flail_7.png man_flail_8.png man_flail_9.png man_flail_10.png man_flail_11.png man_flail_12.png man_flail_13.png man_walking_1_l.png man_walking_2_l.png man_walking_3_l.png man_walking_4_l.png man_walking_5_l.png man_walking_6_l.png man_walking_1_r.png man_walking_2_r.png man_walking_3_r.png man_walking_4_r.png man_walking_5_r.png man_walking_6_r.png".split(" ");
this.man_anims={standing:["man_standing_1.png"],jumping:a.slice(1,6),waving:a.slice(6,14),ascending:a.slice(4,6),falling:a.slice(1,3),saving:a.slice(1,3),flying:["man_jumping_1.png"],flailing:a.slice(14,27),walkingleft:a.slice(27,33),walkingright:a.slice(33,39)};this.textureincrement=0;this.incrementval=1;this.idlestate=this.manstate="standing";this.wavedirection="left";GameObject.call(this,a[0],12,24,b,c,d,g,h,e);this.timeoutID=setTimeout(this.updateTexture.bind(this),160)}
ManObject.constructor=ManObject;ManObject.prototype=Object.create(GameObject.prototype);ManObject.prototype.cleanup=function(){this.timeoutID&&clearTimeout(this.timeoutID)};
ManObject.prototype.everySecond=function(a){a="cheering"===a?0.2:1;"standing"!==this.manstate||"standing"!==this.idlestate&&"walkingleft"!==this.idlestate&&"walkingright"!==this.idlestate||(this.textureincrement=0,this.incrementval=1,this.wavedirection="",this.idlestate="standing",a*=Math.random(),0.1>a?(this.textureincrement=0,this.idlestate="jumping"):0.1<=a&&0.2>a?(this.textureincrement=0,this.idlestate="waving",0.5>Math.random()?this.wavedirection="left":this.wavedirection="right"):0.2<=a&&0.3>
a&&(this.textureincrement=0,this.idlestate="walking",0.5>Math.random()?this.idlestate="walkingleft":this.idlestate="walkingright"))};
ManObject.prototype.updateTexture=function(){var a;if("standing"===this.manstate)a=this.idlestate;else if(a=this.manstate,"saved"===a||"dead"===a)return;this.textureincrement+=this.incrementval;this.textureincrement>=this.man_anims[a].length&&("standing"!==this.manstate||"walkingleft"!==this.idlestate&&"walkingright"!==this.idlestate?(this.incrementval=-this.incrementval,this.textureincrement+=this.incrementval):this.textureincrement=0);0>this.textureincrement&&(this.textureincrement=0,this.incrementval=
1,this.scale.x=1,this.anchor.x=0,this.idlestate="standing");"standing"===this.manstate&&"waving"===this.idlestate&&("right"===this.wavedirection?(this.scale.x=-1,this.anchor.x=1):(this.scale.x=1,this.anchor.x=0));this.visible&&"flying"!==this.status&&(a=PIXI.Texture.fromFrame(this.man_anims[a][this.textureincrement]),this.setTexture(a));this.timeoutID=setTimeout(this.updateTexture.bind(this),160)};
ManObject.prototype.backtrackMan=function(a,b){this.idlestate="walkingleft"===this.idlestate?"walkingright":"walkingleft";return a-b};
ManObject.prototype.updateWalking=function(a){var b,c,d,g,h,e,f,k=!1;b=0+this.worldx;c=0+this.worldy;"walkingleft"===this.idlestate?(f=-0.5,e=b-1):(f=0.5,e=b+12);b+=f;for(a=0;a<this.world.city.length;a++)if(d=this.world.city[a],this.world.isCollidedCoords(d,this.worldx,this.worldy,this.width,this.height+1)){k=!0;g=0===a?this.world.city[this.world.city.length-1]:this.world.city[a-1];h=a===this.world.city.length-1?this.world.city[0]:this.world.city[a+1];if(!this.world.isCollidedCoords(d,e,c+24,1,1,
!1)&&!this.world.isCollidedCoords(g,e,c+24,1,1,!1)&&!this.world.isCollidedCoords(h,e,c+24,1,1,!1)){b=this.backtrackMan(b,f);break}if("walkingleft"===this.idlestate){if(this.world.isCollidedCoords(g,b,c,this.width,this.height,!1)){b=this.backtrackMan(b,f);break}}else if(this.world.isCollidedCoords(h,b,c,this.width,this.height,!1)){b=this.backtrackMan(b,f);break}}k||console.log("Shouldn't get here");for(a=0;a<this.world.men.length;a++)if(d=this.world.men[a].sprite,d!==this&&this.world.isCollidedCoords(d,
b,c,this.width,this.height,!1)){b=this.backtrackMan(b,f);break}this.worldx=b};
ManObject.prototype.update=function(a,b,c,d){this.visible=!1;if("dead"===b.status||"saved"===b.status)this.manstate=b.status;else{b.status!==this.manstate&&(this.incrementval=1,this.textureincrement=0,this.scale.x=1,this.anchor.x=0,this.idlestate="standing");if("falling"===b.status||"saving"===b.status)this.worldy+=0.35*d*PARTSYS.framerate;"ascending"===b.status&&(this.worldy-=0.2*d*PARTSYS.framerate);"flying"===b.status&&(this.worldx=c.worldx+50,this.worldy=c.worldy+c.height,this.worldx>this.worldwidth&&
(this.worldx-=this.worldwidth));this.manstate=b.status;"standing"!==this.manstate||"walkingleft"!==this.idlestate&&"walkingright"!==this.idlestate||this.updateWalking(d);this.position.y=this.worldy;b=a+this.viewwidth;c=-1;b>this.worldwidth&&(c=b-this.worldwidth-1);-1===c?this.worldx>a-this.width&&this.worldx<b+this.width&&(this.position.x=this.worldx-a,this.visible=!0):this.worldx>a-this.width&&this.worldx<=this.worldwidth?(this.position.x=this.worldx-a,this.visible=!0):this.worldx<c+this.width&&
(this.position.x=this.worldwidth-a+this.worldx,this.visible=!0)}};
