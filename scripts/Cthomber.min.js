function Cthomber(a,b,c,e,d,f,g,h){this.world=a;this.stage=b;this.worldwidth=c;this.worldheight=e;this.viewwidth=d;this.viewheight=f;this.worldx=g;this.worldy=h;this.cthlugBirthed=this.birth=!1;this.textures=["cthomber_1.png","cthomber_2.png","cthomber_3.png","cthomber_4.png"];this.textures_birth=["cthomber_birth_1.png","cthomber_birth_2.png","cthomber_birth_3.png","cthomber_birth_4.png"];this.textureincrement=0;this.texturevector=1;this.deltav=new PARTSYS.Vector(0,0);this.cthingsoundplaying=this.onebirth=
!1;this.cthingsound=new Howl({urls:["resources/sounds/cthod_move.mp3"],onend:function(){this.cthingsoundplaying=!1}.bind(this)});GameObject.call(this,this.textures[0],64,64,c,e,d,f,g,h);this.timeoutID=setTimeout(this.updateTexture.bind(this),160)}Cthomber.constructor=Cthomber;Cthomber.prototype=Object.create(GameObject.prototype);Cthomber.prototype.cleanup=function(){this.timeoutID&&clearTimeout(this.timeoutID);this.cthingsound.stop()};
Cthomber.prototype.tracking=function(a,b){b=b||{x:this.worldx,y:this.worldy};var c=a.worldx,e;e=c>b.x?Math.abs(b.x+this.worldwidth-c):b.x-c;c=c<b.x?Math.abs(this.worldwidth-b.x+c):c-b.x;return e<c?-1:e>c?1:0};
Cthomber.prototype.getClosestManDelta=function(){var a,b,c,e={x:this.worldx+26,y:this.worldy+48},d=null,f=null;this.world.player?(f=PARTSYS.distance2(e,{x:this.world.player.worldx,y:this.world.player.worldy}),d=this.world.player):(f=90001,d=null);for(a=b=a=0;a<this.world.men.length;a++)b=this.world.men[a].status,"standing"===b&&(b=this.world.men[a].sprite,c={x:b.worldx,y:b.worldy},c=PARTSYS.distance2(e,c),c<f&&(d=b,f=c));if(null===d)return{dx:0,dy:0};a=this.tracking(d,e);b=e.y>d.worldy?-1:e.y<d.worldy?
1:0;return{dx:a,dy:b}};
Cthomber.prototype.everySecond=function(a){var b,c;this.birth||(0.1>Math.random()&&this.worldy<0.5*this.worldheight?(this.birth=!0,this.deltav.x=0,this.deltav.y=0,this.textureincrement=-1,this.texturevector=1):(a=0===this.deltav.x&&0===this.deltav.y?1:0.75,Math.random()<a&&(a=Math.random(),b=Math.random(),c=this.getClosestManDelta(),0.5<a||0.5<b?this.deltav.x=c.dx:(0.17>a?this.deltav.x=-1:0.34>a?this.deltav.x=1:0.51>a&&(this.deltav.x=0),0.1>b?this.deltav.y=-1:0.15>b?this.deltav.y=1:0.2>b&&(this.deltav.y=
0)))))};Cthomber.prototype.updateSound=function(){this.world.player&&(this.visible&&!this.cthingsoundplaying&&(this.cthingsoundplaying=!0,this.cthingsound.play()),!this.visible&&this.cthingsoundplaying&&(this.cthingsound.stop(),this.cthingsoundplaying=!1))};
Cthomber.prototype.updateTexture=function(){var a;a=this.birth?this.textures_birth:this.textures;this.textureincrement+=this.texturevector;this.textureincrement>=a.length&&(this.texturevector=-this.texturevector,this.textureincrement=a.length-1);0>this.textureincrement&&(this.textureincrement=1,this.texturevector=-this.texturevector);this.visible&&(a=PIXI.Texture.fromFrame(a[this.textureincrement]),this.setTexture(a));this.cthlugBirthed&&0===this.textureincrement&&(this.birth=this.cthlugBirthed=!1,
this.textureincrement=-1,this.texturevector=1);this.timeoutID=setTimeout(this.updateTexture.bind(this),160)};
Cthomber.prototype.update=function(a,b){var c,e=this.worldy,d,f=-1;this.visible=!1;this.birth&&!this.cthlugBirthed&&this.textureincrement===this.textures_birth.length-1&&(this.world.birthCthomb(this.worldx+this.width/2-12,this.worldy+this.height),this.cthlugBirthed=!0);this.worldx+=this.deltav.x*b*PARTSYS.framerate;this.worldy+=this.deltav.y*b*PARTSYS.framerate;0>this.worldy&&(this.worldy=0,this.deltav.y=-this.deltav.y);this.worldy>=0.6*this.worldheight-this.height&&(this.worldy=0.6*this.worldheight-
this.height,this.deltav.y=-this.deltav.y);this.worldx>this.worldwidth&&(this.worldx=this.worldx-this.worldwidth+1);0>this.worldx&&(this.worldx=this.worldwidth+this.worldx-1);d=a+this.viewwidth;d>this.worldwidth&&(f=d-this.worldwidth-1);-1===f?this.worldx>a-this.width&&this.worldx<d+this.width&&(c=this.worldx-a,this.visible=!0):this.worldx>a-this.width&&this.worldx<=this.worldwidth?(c=this.worldx-a,this.visible=!0):this.worldx<f+this.width&&(c=this.worldwidth-a+this.worldx,this.visible=!0);this.visible&&
(this.position.x=c,this.position.y=e);this.updateSound()};
