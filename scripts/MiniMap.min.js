function MiniMap(d,b,c,a){this.stage=d;this.world=b;this.x=c/2-166;this.y=a+5;this.viewwidth=c;this.viewheight=a;this.g=new PIXI.Graphics;this.g.x=this.x;this.g.y=this.y;this.g.height=42;this.g.width=332;this.pause=timeStamp();this.stage.addChild(this.g)}MiniMap.constructor=MiniMap;MiniMap.prototype=Object.create(Object.prototype);MiniMap.prototype.cleanup=function(){this.g.clear()};
MiniMap.prototype.drawObject=function(d,b,c,a,e){var g=null,f;this.g.beginFill(b);b=d.width/12;f=d.height/12;c=e-c+d.worldx/12;c>a&&(c-=a);0>c&&(c=a+c);d=d.worldy/12+1;c+b>a?(g=a-c,this.g.drawRect(c,d,g,f),this.g.drawRect(0,d,b-g,f)):this.g.drawRect(c,d,b,f);this.g.endFill()};
MiniMap.prototype.drawCthings=function(d,b,c){var a,e,g,f;for(a=0;a<this.world.cthings.length;a++){g=this.world.cthings[a].muto?16711680:65280;if(this.world.cthings[a]instanceof Cthod)for(e=0;e<this.world.cthings[a].cthlies.length;e++)f=this.world.cthings[a].cthlies[e],this.drawObject(f,1052688,d,b,c);this.drawObject(this.world.cthings[a],g,d,b,c)}};MiniMap.prototype.drawPlayer=function(d,b,c){this.drawObject(this.world.player,16777215,d,b,c)};
MiniMap.prototype.drawBuildings=function(d,b,c){var a;for(a=0;a<this.world.city.length;a++)this.drawObject(this.world.city[a],526344,d,b,c)};MiniMap.prototype.drawPeople=function(d,b,c){var a,e;for(a=0;a<this.world.men.length;a++)e=this.world.men[a],"dead"!==e.status&&"saved"!==e.status&&this.drawObject(e.sprite,11927807,d,b,c)};MiniMap.prototype.drawTowers=function(d,b,c){var a;for(a=0;a<this.world.towers.length;a++)this.drawObject(this.world.towers[a],46847,d,b,c)};
MiniMap.prototype.update=function(d){var b,c,a,e;d/=12;b=timeStamp();34>b-this.pause||(this.pause=b,a=this.world.worldwidth/12,e=this.world.worldheight/12,b=a/2-this.world.viewwidth/24+1,c=a/2+this.world.viewwidth/24+1,this.g.clear(),this.g.beginFill(0),this.g.lineStyle(1,16776960,1),this.g.moveTo(0,0),this.g.lineTo(a+2,0),this.g.lineTo(a+2,e+2),this.g.lineTo(0,e+2),this.g.lineTo(0,0),this.g.lineStyle(1,16777215,1),this.drawPlayer(d,a,b),this.drawCthings(d,a,b),this.drawBuildings(d,a,b),this.drawPeople(d,
a,b),this.drawTowers(d,a,b),this.g.moveTo(b,5),this.g.lineTo(b,1),this.g.lineTo(c,1),this.g.lineTo(c,5),this.g.endFill(0))};
